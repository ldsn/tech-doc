#鲁大学生网主站后台接口文档
<ul>
  <li>接口解析
    <ul>
      <li>登陆</li>
      <li>注册</li>
      <li>首页</li>
      <li>列表页</li>
      <li>内容页</li>
      <li>个人中心</li>
    </ul>
  </li>
  <li>控制器解析
    <ul>
      <li>ArticleController.class.php</li>
      <li>CommentController.class.php</li>
      <li>IndexController.class.php</li>
      <li>LoginController.class.php</li>
      <li>PublicController.class.php</li>
      <li>RegisterController.class.php</li>
      <li>UserController.class.php</li>
    </ul>
  </li>
  <li>模型解析
    <ul>
      <li>ArticleModel.class.php</li>
      <li>Article_detialModel.class.php</li>
      <li>ColumnModel.class.php</li>
      <li>CommentModel.class.php</li>
      <li>IndexModel.class.php</li>
      <li>UserModel.class.php</li>
    </ul>
  </li>
</ul>
##接口解析

###登陆
#####登陆相关描述：
    1、提供登陆模板的功能。
    2、接收前端传来的用户名和用户密码，进行数据库验证，验证成功或失败，提示信息并进行跳转。
    3、退出，清除cookie，并跳转。

#####接口请求说明：
    http请求: 请求方式POST
    1、登陆模板页面请求：www.ldsn.com/home/login/index
    2、登陆接口请求    ：www.ldsn.com/home/login/login
    3、退出接口请求    ：www.ldsn.com/home/login/logout
#####参数说明：
<table>
  <tr>
    <td>参数</td>
    <td>是否必须</td>
    <td>说明</td>
  </tr>
  <tr>
    <td>username</td>
    <td>是</td>
    <td>获取用户名称并验证</td>
  </tr>
  <tr>
    <td>password</td>
    <td>是</td>
    <td>获取用户密码并验证</td>
  </tr>
  <tr>
    <td>verify</td>
    <td>是</td>
    <td>获取验证码并验证</td>
  </tr>
</table>
---
##注册
#####注册相关描述：
     1、提供注册模板的功能。
     2、接收前端传来的注册信息，进行数据库验证，验证成功或失败，提示信息并进行跳转。
#####接口请求说明：
     http请求: 请求方式POST
    1、注册模板页面请求：www.ldsn.com/home/register/index
    2、注册接口请求    ：www.ldsn.com/home/register/register
#####参数说明:
<table>
  <tr>
    <td>参数</td>
    <td>是否必须</td>
    <td>说明</td>
  </tr>
  <tr>
    <td>verify</td>
    <td>是</td>
    <td>验证码</td>
  </tr>
  <tr>
    <td>username</td>
    <td>是</td>
    <td>用户名</td>
  </tr>
  <tr>
    <td>password</td>
    <td>是</td>
    <td>用户密码</td>
  </tr>
  <tr>
    <td>repassword</td>
    <td>是</td>
    <td>重复密码</td>
  </tr>
  <tr>
    <td>email</td>
    <td>否</td>
    <td>用户邮箱</td>
  </tr>
  <tr>
    <td>qq</td>
    <td>否</td>
    <td>用户qq</td>
  </tr>
</table>
---
##首页、列表页

#####首页、列表页接口描述：
     1、获取首页文章信息和相关评论信息。
     2、获取用户个人信息。
#####接口请求说明：
    http请求: 请求方式GET
    1、获取文章列表请求：www.ldsn.com/home/article/getArticle
    2、获取栏目信息请求：www.ldsn.com/home/index/getColumn
    3、获取个人信息请求：www.ldsn.com/home/user/userinfo
#####参数说明：
######文章信息说明：（默认从1号栏目第0条开始提取10篇文章 每篇提取三个最新评论）
<table>
  <tr>
    <td>参数</td>
    <td>是否必须</td>
    <td>说明</td>
  </tr>
  <tr>
    <td>startid</td>
    <td>否</td>
    <td>提取文章从第几条开始</td>
  </tr>
  <tr>
    <td>getnum</td>
    <td>否</td>
    <td>提取文章数量</td>
  </tr>
  <tr>
    <td>cid</td>
    <td>否</td>
    <td>栏目ID</td>
  </tr>
  <tr>
    <td>comStartId</td>
    <td>否</td>
    <td>评论提取从第几条开始</td>
  </tr>
  <tr>
    <td>comGetNum</td>
    <td>否</td>
    <td>提取评论条数</td>
  </tr>
</table>
######文章信息返回参数说明：
    {
    "error": 0,
    "data": [
        {
            "aid": 3,
            "uid": 1,
            "cid": 1,
            "ismake": 1,
            "favour": 0,
            "visit": 0,
            "comment": 0,
            "title": "测试题目2",
            "desription": null,
            "image": "www.ldustu.com",
            "time": 2,
            "from": "",
            "username": "jason",
            "cominfo": [
                [
                    {
                        "id": "7",
                        "aid": "3",
                        "uid": "4",
                        "content": "测试内容",
                        "time": "1424068953"
                    },
                    {
                        "id": "6",
                        "aid": "3",
                        "uid": "4",
                        "content": "测试内容",
                        "time": "1424068874"
                    },
                    {
                        "id": "3",
                        "aid": "3",
                        "uid": "3",
                        "content": "测试内容",
                        "time": "1423114120"
                    }
                ]
            ]
            "comEnd": true,
            "comListNum": 3
        },
    ],
    "artEnd": true,
    "artListNum": 2,
     }
---
<table>
  <tr>
    <td>参数</td>
    <td>说明</td>
  </tr>
  <tr>
    <td>error</td>
    <td>error返回参数有两个，0表示正常，1表示取不到数据</td>
  </tr>
  <tr>
    <td>data</td>
    <td>返回文章的相关信息，并且包含文章对应的相关评论</td>
  </tr>
  <tr>
    <td>aid，uid，cid，ismake，favour，visit，comment，title，desription，image，time，from，username,cominfo</td>
    <td>文章ID，用户ID，栏目ID，是否审核，点赞数量，评论数量，文章题目，文章描述，图片来源，发布时间，文章来源，用户姓名,评论数组</td>
  </tr>
  <tr>
    <td>id，aid，uid，content，time</td>
    <td>评论ID，文章ID，用户ID，评论内容，评论时间</td>
  </tr>
  <tr>
    <td>artEnd</td>
    <td>文章结束标志：true不能继续取，false可继续取</td>
  </tr>
  <tr>
    <td>artListNum</td>
    <td>取出文章数量</td>
  </tr>
  <tr>
    <td>comEnd</td>
    <td>评论结束标志：true不能继续取，false可继续取</td>
  </tr>
  <tr>
    <td>comListNum</td>
    <td>评论取出数量</td>
  </tr>
</table>
---
######个人信息返回说明：
     {
    "id": "4",
    "username": "jason",
    "email": "123",
    "qq": "123",
    "sign_time": "1422790657",
    "login_time": "1424576062",
    "login_style": "computer"
     }
<table>
  <tr>
    <td>参数</td>
    <td>说明</td>
  </tr>
  <tr>
    <td>id</td>
    <td>用户ID</td>
  </tr>
  <tr>
    <td>username</td>
    <td>用户姓名</td>
  </tr>
  <tr>
    <td>email</td>
    <td>用户邮箱</td>
  </tr>
  <tr>
    <td>qq</td>
    <td>用户QQ</td>
  </tr>
  <tr>
    <td>login_time</td>
    <td>本次登陆时间</td>
  </tr>
  <tr>
    <td>login_style</td>
    <td>本次登陆方式</td>
  </tr>
</table>
##内容页

#####内容页接口描述：
     1、提供对应文章ID，返回给前端该文章的数据
#####接口请求说明：
    http请求: 请求方式GET
    1、获取文章列表请求：www.ldsn.com/home/article/getArticle
#####参数说明：
<table>
  <tr>
    <td>参数</td>
    <td>是否必须</td>
    <td>说明</td>
  </tr>
  <tr>
    <td>aid</td>
    <td>是</td>
    <td>aid是文章的ID号码</td>
  </tr>
</table>
#####返回数据说明：
     {
      "id": "3",
      "uid": "1",
      "cid": "1",
      "cnum": "0",
      "favour": "0",
      "visit": "0",
      "ismake": "1",
      "title": "测试题目2",
      "description": "测试描述2",
      "image": "www.ldustu.com",
      "time": "2",
      "from": "",
      "Article_detial": {
          "id": "2",
          "aid": "3",
          "content": "简单的内容",
          "tag":学生网,
      }
     }
######参数详解：
<table>
  <tr>
    <td>参数</td>
    <td>说明</td>
  </tr>
  <tr>
    <td>id</td>
    <td>文章ID</td>
  </tr>
  <tr>
    <td>uid</td>
    <td>用户ID</td>
  </tr>
  <tr>
    <td>cid</td>
    <td>栏目ID</td>
  </tr>
  <tr>
    <td>cnum</td>
    <td>评论数量</td>
  </tr>
  <tr>
    <td>favour</td>
    <td>点赞数量</td>
  </tr>
  <tr>
    <td>visit</td>
    <td>浏览数量</td>
  </tr>
  <tr>
    <td>ismake</td>
    <td>是否审核</td>
  </tr>
  <tr>
    <td>title</td>
    <td>文章题目</td>
  </tr>
  <tr>
    <td>description</td>
    <td>文章描述</td>
  </tr>
  <tr>
    <td>image</td>
    <td>图片链接</td>
  </tr>
  <tr>
    <td>time</td>
    <td>发布时间</td>
  </tr>
  <tr>
    <td>from</td>
    <td>文章来源</td>
  </tr>
  <tr>
    <td>Article_detial</td>
    <td>文章细节表</td>
  </tr>
  <tr>
    <td>content</td>
    <td>文章内容</td>
  </tr>
  <tr>
    <td>tag</td>
    <td>文章标签</td>
  </tr>
</table>
##功能及接口详解

  Application下的common 目录下的function.php
    function LoginStyle()  
      //获取用户的登录方式;
    function inject_check($sql_str)  
      //防注入过滤;
    function check_verify($code, $id = '')  
      //验证码过滤函数;
    function getRequestParam($request_name, $default_value = null, $method = "all")  
      //安全获取get/post (抓取网页内容所用)
  控制器（controller）功能详解
   ---------------------------------------------------------------------
    ArticleController.class.php
      /*
      *列表页获取文章接口
      *需要传入 $startid(文章从第几条开始),$getnum(取几条),$cid(栏目id),$comStartId(评论从第几条开始),$comGetNum(取出评论数量)
      *直接请求接口返回，从第0条数据，取出10篇文章，栏目为1，评论默认最新的3条
      */
      public function getArticle($startid = 0,$getnum = 10,$cid = 1,$comStartId = 0,$comGetNum = 3)
      /*
      *文章内容页
      *传入文章id
      *返回文章所有的信息
      */
      public function showArticle($aid)
      /*
      *发布文章页面
      *从cookie取值 判断是否显示该页面
      */
      public function Article()
      /*
      *文章发布接口
      *获取多个内容
      *现存测试代码，删掉 简单内容，取消之后注释即可
      *使用关联存储
      */
      public function publish()
      /*
      *抓取文章页面
      *将表单提交到该页面 返回链接抓取内容
      */
      public function curlArticle()
   ---------------------------------------------------------------------
    CommentController.class.php
    /*
    *获取评论接口
    *需要传入 $aid ,$startid,$count 
    *无默认传入
    */
    public function getComment($aid,$startid,$count)
    /*
    *写入评论功能
    *需传入 $uid,$aid,$content
    */
    public function commentin($uid,$aid,$content)
    /*
    *删除评论功能
    *需要传入 $com_id 即评论ID
    */
    public function commentdelete($com_id)
     ---------------------------------------------------------------------
     IndexController.class.php
     /*
     *首页接口 
     *紧提供了一个获取评论，接口，其余接口在其他控制器下，将在接下来的文档中说明
     */
     public function getColumn()
     ---------------------------------------------------------------------
     /*
     *登录首页
     *显示登录页面
     */
     public function index()
     /*
     *登录功能页
     *需传入值 $username $password
     */
     public function login()
     /*
     *退出登录
     */
     public function logout()
    --------------------------------------------------------------------- 
     PublicController.class.php
     /*
     *验证码获取函数
     */
     public function verify($config=array('imageW'=>200,'imageH'=>50,'length'=>4,'useNoise'=>false,'codeSet'=>'0123456789'))
     /*
     *点赞接口
     *需传入$uid,$aid
     */
     public function favour($uid,$aid)
     --------------------------------------------------------------------- 
     RegisterController.class.php
     /*
     *注册页面显示
     */
     public function index()
     /*
     *注册接口
     *需传入$username,$password,$email,$qq
     */
     public function Register()
     --------------------------------------------------------------------- 
     UserController.class.php
     /*
     *用户中心页面
     *功能接口待完善
     */
       public function index()
       /*
       *个人信息获取接口
       *自带cookie检测，无需传值
       */
        public function userinfo()
    模型类(Model)功能详解  // 模型类  封装了控制类使用的函数
    --------------------------------------------------------------------- 
    ArticleModel.class.php
    /*
    *关联表配置
    */
    protected $_link
    /*
    *文章内容页内容获取函数
    *需传入$aid
    */
     public function articleArticle($aid)
     /*
     *发布文章函数
     *传入控制器整合数据
     */
     public function publishArticle($data)
     /*
     *列表文章函数
     *需求 传入由控制器接口限制
     */
     public function getArticle($startid,$getnum,$cid,$comStartId,$comGetNum)
     --------------------------------------------------------------------- 
     ColumnModel.class.php
     /*
     *获取全部栏目函数
     */
     public function getall()
     ---------------------------------------------------------------------
     CommentModel.class.php
     /*
     *评论函数封装
     */
     public function comment($uid,$aid,$content )
     /*
     *删除评论函数
     */
     public function deleteComment($com_id)
     ---------------------------------------------------------------------
     UserModel.class.php
     /*
     *获取用户名对应id
     *函数封装
     */
    public function userid($username)
    /*
    *检查用户名是否重复
    *函数封装
    */
    public function checkname($username)
    /*
    *检查邮箱是否合法
    *函数封装
    */
    public function checkemail($email)
    /*
    *获取用户信息
    *函数封装
    */
    public function userinfo($username)
